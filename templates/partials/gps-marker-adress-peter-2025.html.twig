<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css">
<script src="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js"></script>




<style>
     #map { height:300px; } 
    .leaflet-container {
			height: 300px;
			width: 800px;
			max-width: 100%;
			max-height: 100%;
		}
</style>
    
   
</head>
    
<body onload="geocode()">

<div id="map"></div>     
<div id="result"></div> 

    
<script>
    
async function geocode() {
      const address = "{{ page.title }}";
     // const address = document.getElementById('addressInput').value;
      const url = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(address)}&format=json`;

      try {
        const response = await fetch(url);
        const data = await response.json();

        if (data.length > 0) {
          const lat = data[0].lat;
          const lon = data[0].lon;
      
          document.getElementById('result').innerText = `${lat},${lon},"{{ page.title }}",{{ page.url }}`;
         
          const map = L.map('map').setView([lat, lon], 13);
          const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map); 
    
   

    
     L.easyButton('fa-home', function(btn, map){
    map.setView([lat,lon], 13);
    }).addTo(map);
    
   
    
    
     var helloPopup = L.popup().setContent('Hallo Besucher!');
     L.easyButton('fa-globe', function(btn, map){
     helloPopup.setLatLng(map.getCenter()).openOn(map);
    }).addTo(map);
            
            
            
    L.marker([lat, lon]).addTo(map)
      .bindPopup('{{ page.title }}')
      .openPopup();    
     
     
  
   
     
     
     
     
     
     
     

            
        } else {
          document.getElementById("map").style.height = 0;
          document.getElementById('result').innerText = 'Adresse nicht gefunden';
        }
      } catch (error) {
        document.getElementById('result').innerText = 'Error w√§hrend geocoding';
        console.error(error);
      }
}    


    
    
</script>
    
 

</body>


</html>


